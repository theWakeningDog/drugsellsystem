<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <title>药品列表</title>
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="/dist/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="/dist/css/ionicons.min.css">
    <!-- icheck -->
    <link rel="stylesheet" href="/plugins/iCheck/flat/blue.css">
    <!-- daterange picker -->
    <link rel="stylesheet" href="/plugins/daterangepicker/daterangepicker.css">
    <!-- DataTables -->
    <link rel="stylesheet" href="/plugins/datatables/dataTables.bootstrap.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="/dist/css/AdminLTE.min.css">
</head>
<body style="background: #ecf0f5;">
<div class="row">
    <section class="content">
        <div class="col-md-3">
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">所属仓库</h3>
                    <div class="box-tools">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body no-padding">
                    <ul class="nav nav-pills nav-stacked">
                        <li id="all-drug">
                            <a href="javascript:" onclick='chooseWarehouse(this)'>
                                <i class="fa fa-filter"></i> 全部
                                <span class="label label-danger pull-right" th:text="${drugAllNum}">65</span>
                            </a>
                        </li>
                        <!--<li><a href="javascript:"><i class="fa fa-envelope-o"></i> Sent</a></li>
                        <li><a href="javascript:"><i class="fa fa-file-text-o"></i> Drafts</a></li>
                        <li><a href="javascript:"><i class="fa fa-filter"></i> Junk <span class="label label-warning pull-right">65</span></a>
                        </li>
                        <li><a href="javascript:"><i class="fa fa-trash-o"></i> Trash</a></li>-->
                    </ul>
                    <ul class="nav nav-pills nav-stacked ul-active" th:each="warehouse,stat : ${warehouseList}">
                        <li>
                            <!--th:attr这样可以自定义属性，下面两个都可以取到warehouseId-->
                            <a href="javascript:" th:value="${warehouse.id}" th:attr="warehouseId=${warehouse.id}" onclick='chooseWarehouse(this)'>
                                    <i class="fa fa-inbox"></i> <span th:text="${warehouse.name}">Inbox</span>
                                    <span th:class="${stat.odd} ? 'label label-success pull-right' : 'label label-primary pull-right'" th:text="${warehouse.drugNum}">12</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /. box -->
        </div>
        <!-- /.col -->
        <div class="col-md-9">
            <form action="/drug">
                <div th:class="${drugSearchModel.searchClosed} ? 'box collapsed-box' : 'box'">
                    <div class="box-header">
                        <div class="col-md-6"></div>
                        <div class="col-md-6">
                            <div class="input-group">
                                <input class="form-control keyword-search criteria" name="name" th:value="${drugSearchModel.name}" placeholder="请输入药品名称">
                                <span class="input-group-btn">
                                    <button class="btn btn-primary">搜索</button>
                                    <button type="button" class="btn btn-link <!--btn-box-tool-->" data-widget="collapse">高级搜索&nbsp;&nbsp;<i th:class="${drugSearchModel.searchClosed} ? 'fa fa-plus' : 'fa fa-minus'"></i></button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="box-body">

                    </div>
                </div>
            </form>
            <div class="box box-success">
                <!--<div class="box-header with-border">
                    <div class="box-tools pull-right">
                        <div class="has-feedback">
                            <input type="text" class="form-control" placeholder="Search Mail">
                            <span class="glyphicon glyphicon-search form-control-feedback"></span>
                        </div>
                    </div>
                    &lt;!&ndash; /.box-tools &ndash;&gt;
                </div>-->
                <!-- /.box-header -->
                <div class="box-body no-padding">
                    <div class="mailbox-controls">
                        <!-- Check all button -->
                        <button type="button" class="btn btn-default btn-sm checkbox-toggle"><i class="fa fa-check-square-o"></i></button>
                        <div class="btn-group">
                            <button type="button" class="btn btn-default btn-sm"><i class="fa fa-trash-o"></i></button>
                            <button type="button" class="btn btn-default btn-sm"><i class="fa fa-reply"></i></button>
                            <button type="button" class="btn btn-default btn-sm"><i class="fa fa-share"></i></button>
                        </div>
                        <!-- /.btn-group -->
                        <button type="button" class="btn btn-default btn-sm"><i class="fa fa-refresh"></i></button>
                        <!--<div class="pull-right">
                            1-50/200
                            <div class="btn-group">
                                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-left"></i></button>
                                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-right"></i></button>
                            </div>
                            &lt;!&ndash; /.btn-group &ndash;&gt;
                        </div>-->
                        <!-- /.pull-right -->
                    </div>
                    <div class="<!--table-responsive--> mailbox-messages">
                        <table id="drug-table" class="table table-striped table-bordered table-hover">
                            <thead>
                                <th><input type="checkbox" disabled></th>
                                <th>药品编号</th>
                                <th>药品名称</th>
                                <th>药品通用名</th>
                                <th>药品单位</th>
                                <th>药品数量</th>
                                <th>零售价(元)</th>
                                <th>药品类别</th>
                                <th>药品产地</th>
                                <!--<th>所属仓库</th>-->
                            </thead>
                            <tbody>
                                <tr th:each="drug : ${drugList}">
                                    <td><input type="checkbox"></td>
                                    <td><a th:href="@{/drug/view(drugId=${drug.id})}" th:text="${drug.no}">OTCffdp</a></td>
                                    <td th:text="${drug.name}">复方丹参片</td>
                                    <td th:text="${drug.commonName}">复方丹参片</td>
                                    <td th:text="${drug.unit}">瓶</td>
                                    <td th:text="${drug.number}">100</td>
                                    <td th:text="${drug.retail}">120</td>
                                    <td><a th:href="@{/sort/view(sortId=${drug.sort.id})}" th:text="${drug.sort.name}">中药</a></td>
                                    <td th:text="${drug.origin}">广州白云山制药</td>
                                    <!--<td><a th:href="@{/warehouse/view(warehouseId=${drug.warehouse.id})}" th:text="${drug.warehouse.name}">常温库</a></td>-->
                                </tr>
                            </tbody>
                        </table>
                        <!-- /.table -->
                    </div>
                    <!-- /.mail-box-messages -->
                </div>
                <!-- /.box-body -->
                <!--<div class="box-footer no-padding">
                    <div class="mailbox-controls">
                        &lt;!&ndash; Check all button &ndash;&gt;
                        <button type="button" class="btn btn-default btn-sm checkbox-toggle"><i class="fa fa-square-o"></i>
                        </button>
                        <div class="btn-group">
                            <button type="button" class="btn btn-default btn-sm"><i class="fa fa-trash-o"></i></button>
                            <button type="button" class="btn btn-default btn-sm"><i class="fa fa-reply"></i></button>
                            <button type="button" class="btn btn-default btn-sm"><i class="fa fa-share"></i></button>
                        </div>
                        &lt;!&ndash; /.btn-group &ndash;&gt;
                        <button type="button" class="btn btn-default btn-sm"><i class="fa fa-refresh"></i></button>
                        <div class="pull-right">
                            1-50/200
                            <div class="btn-group">
                                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-left"></i></button>
                                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-right"></i></button>
                            </div>
                            &lt;!&ndash; /.btn-group &ndash;&gt;
                        </div>
                        &lt;!&ndash; /.pull-right &ndash;&gt;
                    </div>
                </div>-->
            </div>
            <!-- /. box -->
        </div>
    </section>
</div>
<script src="/plugins/jQuery/jquery-3.1.1.js"></script>
<script src="/bootstrap/js/bootstrap.js"></script>
<!-- DataTables -->
<script src="/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/plugins/datatables/dataTables.bootstrap.min.js"></script>
<script src="/dist/js/app.js"></script>
<script src="/plugins/iCheck/icheck.js"></script>
<!-- date-range-picker -->
<script src="/plugins/moment/moment.js"></script>
<script src="/plugins/daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" th:inline="text">
    //点击仓库
    function chooseWarehouse(ele) {
        //对于th：attr、th：value可以这么取值
        console.log($(ele).attr("warehouseId"));
        console.log($(ele).attr("value"));
        var warehouseId = $(ele).attr("warehouseId") || "";
        window.location.href="/drug?warehouseId=" + warehouseId
    }
    $(function () {
        //点击仓库处于active状态
        var $childA = $(".ul-active");
        for (var i = 0; i < $childA.length; i++) {
            var child = $childA[i];
            //这是一个dom
            console.log(child);
            //需要用$(child)，把child转换为jQuery对象，才可以用jQuery的操作
            console.log($(child).find("a").attr("warehouseId"));
            console.log('${drugSearchModel.warehouseId}');
            if ('[[${drugSearchModel.warehouseId}]]' == $(child).find("a").attr("warehouseId")) {
                $(child).find("li").attr("class", "active");
                break;
            } else if ('[[${drugSearchModel.warehouseId}]]' == "null") {
                $("#all-drug").attr("class", "active");
                break;
            }
        }


        //iCheck的点击事件
        $('.mailbox-messages input[type="checkbox"]').iCheck({
            checkboxClass: 'icheckbox_flat-blue',
            radioClass: 'iradio_flat-blue'
        });
        //Enable check and uncheck all functionality
        $(".checkbox-toggle").click(function () {
            var clicks = $(this).data('clicks');
            if (clicks) {
                //Uncheck all checkboxes
                $(".mailbox-messages input[type='checkbox']").iCheck("uncheck");
                $(".fa", this).removeClass("fa-check-square-o").addClass('fa-square-o');
            } else {
                //Check all checkboxes
                $(".mailbox-messages input[type='checkbox']").iCheck("check");
                $(".fa", this).removeClass("fa-square-o").addClass('fa-check-square-o');
            }
            $(this).data("clicks", !clicks);
        });

        $("#drug-table").dataTable({
            renderer: "bootstrap",
            paging: true, //是否显示分页
            info: true, //是否显示表格左下角的信息
            lengthChange: false, //是否允许用户改变表格每页显示的记录数
            ordering: true, //是否允许Datatables开启排序
            scrollX: true, //设置水平滚动
            scrollY: false,
            iDisplayLength : 10,
            searching: false, //是否允许Datatables开启本地搜索
            stateSave: false, //保存状态 - 在页面重新加载的时候恢复状态（页码等内容），慎用
            autoWidth: false, //控制Datatables是否自适应宽度
            deferRender: true, //控制Datatables的延迟渲染，可以提高初始化的速度
            order: [], //设置第几列可以排序，是空的，可以去掉默认的排序（默认：第一列升序）
            "aoColumnDefs": [ { "bSortable": false, "aTargets": [ 0, 4 ] }],
            "sPaginationType" : "full_numbers",
            "oLanguage" : {
                "sLengthMenu": "每页显示 _MENU_ 条记录",
                "sZeroRecords": "抱歉， 没有找到",
                "sInfo": "从 _START_ 到 _END_ /共 _TOTAL_ 条数据",
                "sInfoEmpty": "没有数据",
                "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
                "sZeroRecords": "没有检索到数据",
                "sSearch": "名称:",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "前一页",
                    "sNext": "后一页",
                    "sLast": "尾页"
                }
            }
        });

    });
</script>
</body>
</html>